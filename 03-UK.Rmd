# UK - 2012 London Olympics    
<font size="6"><b> Analysis of Regional Economic Impacts of Hosting Olympics on the United Kingdom </b></font> 

## UK GDP   
Source Data:    


```{r include=FALSE}
library(ggplot2)
library(tidyverse)
library(dplyr)
library(naniar)
library(zoo)
library(reactable)
library(scales)
library(ggridges)
library(viridis)
library(gganimate)
library(gifski)
library(magick)
library(readxl)
```

```{r include=FALSE}
uk_gdp <- read.csv('/Users/xiayunj/Desktop/datathon/supplementary_data/uk_gdp.csv')
names(uk_gdp) <- c('Region','1998','1999','2000','2001','2002','2003','2004','2005','2006',
                   '2007','2008','2009','2010','2011','2012','2013','2014','2015','2016',
                   '2017','2018')
uk_gdp <- uk_gdp[1:14,]
```


```{r include=FALSE}
uk_gdp_clean <- data.frame('Year' = numeric(), 'Region' = factor(), 'GDP' = numeric())
for (i in 1:nrow(uk_gdp)){
  for (j in c('1998','1999','2000','2001','2002','2003','2004','2005','2006',
                   '2007','2008','2009','2010','2011','2012','2013','2014','2015','2016',
                   '2017','2018')){
    uk_gdp_clean <- uk_gdp_clean %>% add_row(Year = as.numeric(j), 
                                             Region = uk_gdp$Region[i],
                                             GDP = as.numeric(as.character(gsub(',','',uk_gdp[i, j]))))
  }
}
```

```{r echo=FALSE, fig.height=5, fig.width=10}
ggplot(uk_gdp_clean[which(uk_gdp_clean$Region == 'United Kingdom'),], 
       aes(Year, GDP, color=Region)) + 
  geom_line(size =1.5, color = 'blue') +
  geom_vline(xintercept = 2012, linetype="dashed", color = "red", size=1.5) +
  geom_text(aes(x = 2012, label = 'London Olympics', y = 1400000), colour = 'black', size = 4) +
  geom_vline(xintercept = 2005, linetype="dashed", color = "red", size=1.5) +
  geom_text(aes(x = 2005, label = 'Final Selection', y = 1600000), colour = 'black', size = 4) +
  ggtitle('GDP of the United Kingdom', subtitle = 'From 1998 to 2018') +
  labs(x = 'Year', y = 'GDP at Current Market Price') +
  scale_x_continuous(breaks = seq(1998, 2018, 2)) +
  theme_gray(13)
```

```{r echo=FALSE, fig.height=5, fig.width=10}
ggplot(uk_gdp_clean[which(uk_gdp_clean$Region != 'England' & uk_gdp_clean$Region != 'United Kingdom'),], 
       aes(Year, GDP, color=Region)) + 
  geom_line() +
  geom_vline(xintercept = 2012, linetype="dashed", color = "red", size=1.5) +
  geom_text(aes(x = 2012, label = 'London Olympics', y = 300000), colour = 'black', size = 4) +
  geom_vline(xintercept = 2005, linetype="dashed", color = "red", size=1.5) +
  geom_text(aes(x = 2005, label = 'Final Selection', y = 350000), colour = 'black', size = 4) +
  ggtitle('UK GDP by Regions', subtitle = 'From 1998 to 2018') +
  labs(x = 'Year', y = 'GDP at Current Market Price', color = 'Regions') +
  scale_x_continuous(breaks = seq(1998, 2018, 2)) +
  theme_gray(13)
```

<font size="5"><b> UK Regional GDP Increasing Rate from 1999 to 2018 </b></font>    
```{r include=FALSE}
uk_gdp_rate_temp <- uk_gdp_clean[43:294,]
uk_gdp_rate <- data.frame('Year' = c('1999','2000','2001','2002','2003','2004','2005','2006',
                   '2007','2008','2009','2010','2011','2012','2013','2014','2015','2016',
                   '2017','2018'))
```

```{r include=FALSE}
for (i in 1999:2018){
  for (j in c("East Midlands","East of England","London","North East","North West",
              "Northern Ireland","Scotland","South East","South West","Wales",
              "West Midlands","Yorkshire and The Humber")){
      uk_gdp_rate[i-1998, j] <- round(as.numeric(
      (uk_gdp_rate_temp[which(uk_gdp_rate_temp$Year == i & 
                                uk_gdp_rate_temp$Region == j), 'GDP'] - 
      uk_gdp_rate_temp[which(uk_gdp_rate_temp$Year == i-1 & 
                               uk_gdp_rate_temp$Region == j), 'GDP']) /
      uk_gdp_rate_temp[which(uk_gdp_rate_temp$Year == i-1 & 
                               uk_gdp_rate_temp$Region == j), 'GDP']), 5)
              }
}
```

```{r include=FALSE}
temp_col <- numeric(20*12)
for (i in 1:20){
  for (j in 2:13){
    temp_col <- c(temp_col, as.numeric(uk_gdp_rate[i,j]))
  }
}
```

```{r echo=FALSE}
orange_pal <- function(x) rgb(colorRamp(c("#ffe4cc", "#ff9500"))(x), maxColorValue = 255)
reactable(
  uk_gdp_rate,
  defaultColDef = colDef(
    align = 'center',
    headerStyle = list(background = "#D1E5FC"),
    format = colFormat(percent = TRUE, digits = 2),
    style = function(value) {
    if (!is.numeric(value)) {
      color <- "#A9D0FD"
      list(background = color)
    } else {
    normalized <- (value - min(temp_col)) / (max(temp_col) - min(temp_col))
    color <- orange_pal(normalized)
    list(background = color)
    }
  }
  ),
  bordered = TRUE,
  defaultPageSize = 5
)
```

## UK Unemployment Rate    
 
```{r include=FALSE}
#uk_un <- read_excel('/Users/xiayunj/Desktop/datathon/supplementary_data/uk_un.xlsx')
```
 


## UK International Tourism    

```{r fig.align='center', echo=FALSE, include=identical(knitr:::pandoc_to(), 'html'), fig.link='https://github.com/xiayunj/2020_summer_invitational_datathon'}
knitr::include_graphics('extra_plots/UK_tourists.png', dpi = NA)
```


```{r fig.align='center', echo=FALSE, include=identical(knitr:::pandoc_to(), 'html'), fig.link='https://github.com/xiayunj/2020_summer_invitational_datathon'}
knitr::include_graphics('extra_plots/UK_regional_visits.png', dpi = NA)
```

```{r fig.align='center', echo=FALSE, include=identical(knitr:::pandoc_to(), 'html'), fig.link='https://github.com/xiayunj/2020_summer_invitational_datathon'}
knitr::include_graphics('extra_plots/UK_regional_spend.png', dpi = NA)
```

```{r fig.align='center', echo=FALSE, include=identical(knitr:::pandoc_to(), 'html'), fig.link='https://github.com/xiayunj/2020_summer_invitational_datathon'}
knitr::include_graphics('extra_plots/UK_regional_nights.png', dpi = NA)
```

```{r fig.align='center', echo=FALSE, include=identical(knitr:::pandoc_to(), 'html'), fig.link='https://github.com/xiayunj/2020_summer_invitational_datathon'}
knitr::include_graphics('extra_plots/UK_paired_tourists.jpeg', dpi = NA)
```

